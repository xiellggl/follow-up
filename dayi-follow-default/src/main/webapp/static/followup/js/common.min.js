define(function(require,exports,module){require("layer");layer.config({path:"/static/public/js/layer/"});exports.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};exports.isJson=function(e){return Object.prototype.toString.call(e).toLowerCase()==="[object object]"&&!e.length};exports.str={dTrim:function(e){if(e!=null&&e!=""){return e.replace(/^(\s|\u00A0)+/,"").replace(/(\s|\u00A0)+$/,"")}else{return""}},par2Json:function(e,t){var n={};var a=e.split("&");var r=decodeURIComponent;var i,o;$.each(a,function(e,a){a=a.split("=");i=r(a[0]);o=r(a[1]);n[i]=t||!n[i]?o:[].concat(n[i]).concat(o)});return n},len:function(e,t){var n=0;if(arguments.length>0){if(t==2){for(var a=0;a<e.length;a++){n=n+(e.charCodeAt(a)>128?2:1)}}else{for(var a=0;a<e.length;a++){n=n+(e.charCodeAt(a)>128?1:.5)}}return Math.ceil(n)}else{return null}},hideMoney:function(e){var t=e.toFixed(2).toString();if(e<100){return t}var n=t.split(".");var a=n[0].length;var r="*";for(var i=1;i<a-2;i++){r+="*"}return n[0].substring(0,2)+r+"."+n[1]}};exports.arr={unique:function(e){var t=[],n={};var a=e.length;for(var r=0;r<a;r++){if(!n[e[r]]){if(e[r]!=""){t.push(e[r])}n[e[r]]=true}}return t},systemSort:function(e,t,n){t=t||1;return e.sort(function(e,a){if(n){return t*(e[n]-a[n])}else{return t*(e-a)}})}};exports.loadSecond=function(e,t,n){var a=t;var r=setInterval(function(){if(a==0){clearInterval(r);if(typeof n=="function")n()}else{e.text(a)}a--},1e3)};exports.getCaptcha=function(e){var t=e.attr("src").split("?")[0],n=+new Date,a=t+"?t="+n;e.attr("src",a)};exports.checkBox=function(e,t,n,a){e.off("change");t.off("change");e.change(function(){e.prop("checked",this.checked);t.prop("checked",this.checked);r()});t.change(function(n){n.stopPropagation();e.prop("checked",t.size()==t.filter(":checked").size());r()});var r=function(){if(typeof a=="function"){a()}if(n==null){return}var e=[];t.filter(":checked").each(function(){e.push($(this).val())});n.val(e+"")}};exports.isIE=function(){if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/6./i)=="6."){return 6}else if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/7./i)=="7."){return 7}else if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/8./i)=="8."){return 8}else if(navigator.appName=="Microsoft Internet Explorer"&&navigator.appVersion.match(/9./i)=="9."){return 9}return-1};exports.dateFormat=function(e,t){if(e==null){return}e=new Date(e);var n={M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),q:Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};t=t.replace(/([yMdhmsqS])+/g,function(t,a){var r=n[a];if(r!==undefined){if(t.length>1){r="0"+r;r=r.substr(r.length-2)}return r}else if(a==="y"){return(e.getFullYear()+"").substr(4-t.length)}return t});return t};exports.formatNumber=function(e,n){var a=n;n=n>0&&n<=20?n:2;e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var r=e.split(".")[0].split("").reverse(),o=e.split(".")[1];t="";for(i=0;i<r.length;i++){t+=r[i]+((i+1)%3==0&&i+1!=r.length?",":"")}if(a==0){return t.split("").reverse().join("")}return t.split("").reverse().join("")+"."+o};exports.Cookie={_defaults:{hours:24*30,path:null,domain:null,secure:false},set:function(e,t,n){var a=$.extend(this._defaults,n);var r="";if(a.hours!=null){var i=new Date;var o=a.hours*3600*1e3;i.setTime(i.getTime()+o);r="; expires="+i.toGMTString()}document.cookie=e+"="+escape(t)+r+(a.path==null?"":"; path="+a.path)+(a.domain==null?"":"; domain="+a.domain)+(a.secure==true?"; secure":"")},get:function(e){var t=document.cookie,n=t.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));if(n!=null){return unescape(n[2])}return null},remove:function(e,t){var n=$.extend(this._defaults,t);n.hours=-1;this.set(e,"",n)}};exports.markCurrentStatus=function(e,t,n,a){var r=a||"current";if(e.attr("data-type")=="unFixed"){e.find('[data-id="'+n+'"]').addClass(r)}else{e.find(t).eq(n).addClass(r)}};exports.inputEnterCallback=function(e,t){e.on("keyup",function(e){var n=window.event||e;if((n.keyCode||n.which)==13){t()}})};exports.successMsg=function(e,t){layer.msg('<div class="msg_success">'+e+"</div>",{shade:.1,skin:"layui-layer-hui"},function(){if(typeof t=="function"){t()}else if(t=="reload"){window.location.reload(true)}})};exports.ajax={loadingIndex:null,sessionTimeout:function(e){$(document).ajaxError(function(t,n,a,r){var i=/<title>.*?登录.*?<\/title>/;if(i.test(n.responseText)){layer.alert('<p class="tc cRed">登录超时</p>',{title:"温馨提示",end:function(){if(typeof e=="function"){e(a)}else{window.location.reload(true)}}})}})},handle:function(e){var t=this;var n={method:"post",url:"",data:null,processData:true,contentType:"application/x-www-form-urlencoded",dataType:"json",jsonp:false,async:true,$btn:null,isLoadding:false,timeout:0,offlineback:null,succback:null,failback:null};var a=$.extend(n,e);var r=a.url;r+=r.indexOf("?")==-1?"?":"&";r+="t="+(new Date).getTime();var i;if(i!=null){i.abort()}i=$.ajax({method:a.method,url:r,data:a.data,processData:a.processData,contentType:a.contentType,async:a.async,dataType:a.dataType,jsonp:a.jsonp,timeout:a.timeout,beforeSend:function(){if(a.isLoadding){t.loadingIndex=layer.load(16,{shade:[.1,"#fff"],area:["60px","24px"]})}if(a.$btn){a.$btn.prop("disabled",true)}}}).fail(function(e,n,r){if(t.loadingIndex){layer.close(t.loadingIndex)}layer.alert('<p class="tc cRed">请求出错，请稍后重试！</p>',{title:"温馨提示"});if(a.$btn){a.$btn.prop("disabled",false)}}).done(function(e){if(a.dataType=="html"||a.dataType==null){var t=/<title>.*?登录.*?<\/title>/;if(t.test(e)){layer.alert('<p class="tc cRed">登录超时</p>',{title:"温馨提示",end:function(){window.location.reload(true)}});return false}if(typeof a.succback=="function"){a.succback(e)}return}if(e.succ===true||e.succ==="true"||e.retCode==="success"||e.retCode==="SUCCESS"){if(typeof a.succback=="function"){a.succback(e)}else{exports.successMsg(e.msg,"reload")}}else if(e.status=="300"||e.status=="310"||e.isLogin==false){layer.alert('<p class="tc cRed">登录超时</p>',{title:"温馨提示",end:function(){if(typeof a.offlineback=="function"){a.offlineback(e)}else if(a.offlineback=="reload"){window.location.reload(true)}else{var t=window.location.pathname;window.location.href="/followup/login?goTo="+encodeURIComponent(t)}}})}else{if(a.$btn){a.$btn.prop("disabled",false)}if(typeof a.failback=="function"){a.failback(e)}else{layer.alert('<p class="tc cRed">'+e.msg+"</p>",{title:"温馨提示"})}}}).always(function(e,n){if(t.loadingIndex){layer.close(t.loadingIndex)}if(n=="timeout"){i.abort();layer.alert('<p class="tc cRed">请求超时，请稍后重试！</p>',{title:"温馨提示"})}});return i}};exports.loadPageHTML=function(e,t,n,a){var r=n||$("#htmlContainer");var i=a==null?true:a;exports.ajax.handle({type:"get",url:e,data:t,isLoadding:i,dataType:"html",succback:function(e){if(exports.ajax.loadingIndex){layer.close(exports.ajax.loadingIndex)}if(typeof n=="function"){n(e)}else{r.html(e)}}})};exports.clickPageFn=function(e,t,n,a){n.on("click",".pages a",function(){var r=$(this).data("id");var i=e.indexOf("?")==-1?"?":"&";var o=e+i+"pageNo="+r;exports.loadPageHTML(o,t,n,a);return false})};exports.exportFn=function(e,t){t=decodeURIComponent(t,true);if(e&&t){t=typeof t=="string"?t:$.param(t);var n="";$.each(t.split("&"),function(){var e=this.split("=");n+='<input type="hidden" name="'+e[0]+'" value="'+e[1]+'" />'});$('<form action="'+e+'" method="post" target="_blank">'+n+"</form>").appendTo("body").submit().remove()}};exports.btnStateOperate=function(){$("body").on("click",".state-btn",function(){var e=this.href,t=$(this).data("id"),n=$(this);exports.ajax.handle({url:e,data:{x:t},succback:function(e){var t=e.data.status==1?"btn-yellow":"btn-danger";var a='<button class="btn btn-minier '+t+'">'+e.data.txt+"</button>";n.html(a).attr("title",e.msg);return false}});return false})};exports.btnConfirmOperate=function(){$("body").on("click",".confirm-rst-url-btn",function(){var e=this.href,t=$(this).data("info");layer.confirm(t,{icon:3},function(t){layer.close(t);exports.ajax.handle({url:e})});return false})};exports.listOrder=function(e){e.on("click","#btnorder",function(){var t=$(this).attr("href");if(!t){t=e.data("action")}exports.ajax.handle({url:t,data:$("input.list_order").serialize()});return false})};exports.checksOption=function(e){e.on("click",'[data-rel="multiTermBtn"]',function(){var t=$(this).attr("href");if(!t){t=e.attr("action")}var n=[];e.find('input[data-rel="id"]:checked').each(function(){n.push($(this).val())});if(!n.length){layer.alert("至少选择一个项",{icon:5});return false}exports.ajax.handle({url:t,data:$('input[data-rel="id"]').serialize()});return false})};exports.head=function(e,t){if(e!=undefined){var n=$("#navSide");var a=n.find('[data-rel="'+e+'"]').addClass("active");if(t!=undefined){a.addClass("open").find('[data-index="'+t+'"]').addClass("active")}}var r=$("#userMenu");var i=$("#myModalInfo");r.find('[data-act="info"]').on("click",function(){exports.loadPageHTML("/followup/uc/myinfo",null,function(e){i.html(e).show(300);require.async("clipboard",function(){var e=new Clipboard("#copyLink");e.on("success",function(e){exports.successMsg('<div class="msg_success">复制成功</div>')});e.on("error",function(e){var t='<p class="tc red">复制失败，请手动复制下面网址</p>'+"<p>"+e.text+"</p>";layer.alert(t,{title:"温馨提示"})})})})});r.find('[data-act="pwd"]').on("click",function(){exports.loadPageHTML("/followup/uc/pwd",null,function(e){i.html(e).show(300);var t=i.find("form");require.async(["validate","addMethod"],function(){t.validate({rules:{oldPwd:"required",newPwd:{required:true,isPassword:true,minlength:8,maxlength:20},confirmNewPwd:{required:true,equalTo:"#newPwd"}},messages:{oldPwd:"请输入旧密码",newPwd:{require:"请输入新密码",isPassword:"密码须包含数字、字母或下划线",minlength:"请输入8至20位密码",maxlength:"请输入8至20位密码"},confirmNewPwd:{required:"请再次确认密码",equalTo:"两次密码输入不一致"}},errorPlacement:function(e,t){var n=t.closest(".form-group").find(".tips_box");if(n.length){n.html(e)}else{t.after(e)}},errorClass:"field-error",success:function(e,t){e.remove();return true},submitHandler:function(e){exports.ajax.handle({url:"/followup/uc/update/pwd.json",data:t.serialize()});return false}})})})});$("#btnLogout").on("click",function(){var e=this.href,t=$(this).data("info");layer.confirm(t,{icon:3},function(t){layer.close(t);window.location.href=e});return false});$(function(){$("[title]").tooltip()})}});