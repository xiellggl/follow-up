(function(t){if(typeof define==="function"&&define.amd){define(["zepto"],t)}else{t(window.Zepto||window.jQuery)}})(function(t){t.fn.drawDoughnutChart=function(a,e){var n=this,i=n.width(),r=n.height(),o=i/2,u=r/2,s=Math.cos,m=Math.sin,f=Math.PI,l=t.extend({baseColor:"#37cffa",baseOpacity:.5,baseOffset:10,edgeOffset:10,percentageInnerCutout:85,animation:true,animationSteps:30,animationEasing:"easeInOutExpo",animateRotate:true,tipOffsetX:-8,tipOffsetY:-45,tipClass:"doughnutTip",summaryClass:"doughnutSummary",summaryTitle:"TOTAL:",summaryTitleClass:"doughnutSummaryTitle",summaryNumberClass:"doughnutSummaryNumber",beforeDraw:function(){},afterDrawed:function(){}},e),p={linear:function(t){return t},easeInOutExpo:function(t){var a=t<.5?8*t*t*t*t:1-8*--t*t*t*t;return a>1?1:a}},c=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();l.beforeDraw.call(n);var w=t('<svg width="'+i+'" height="'+r+'" viewBox="0 0 '+i+" "+r+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"></svg>'),d=[],g=p[l.animationEasing],h=I([r/2,i/2])-l.edgeOffset,v=h*(l.percentageInnerCutout/100),y=0;var x=h+l.baseOffset,b=v-l.baseOffset;var T=function(){var a=-1.57,e=6.2831,n=4.7131,i=o+s(a)*x,r=u+m(a)*x,f=o+s(a)*b,p=u+m(a)*b,c=o+s(n)*x,d=u+m(n)*x,g=o+s(n)*b,h=u+m(n)*b;var v=["M",i,r,"A",x,x,0,1,1,c,d,"L",g,h,"A",b,b,0,1,0,f,p,"Z"];t(document.createElementNS("http://www.w3.org/2000/svg","path")).attr({d:v.join(" "),fill:l.baseColor,"fill-opacity":l.baseOpacity}).appendTo(w)}();var A=t(document.createElementNS("http://www.w3.org/2000/svg","g"));A.attr({opacity:0}).appendTo(w);n.append(w);var C=(v-(h-v))*2,O=t('<div class="'+l.summaryClass+'" />').appendTo(n).css({width:C+"px",height:C+"px","margin-left":-(C/2)+"px","margin-top":-(C/2)+"px"}).append('<p class="'+l.summaryTitleClass+'">'+l.summaryTitle+"</p>");var N=t('<p class="'+l.summaryNumberClass+'">0</p>').appendTo(O).css({opacity:0});for(var E=0,F=a.length;E<F;E++){y+=a[E].value;d[E]=t(document.createElementNS("http://www.w3.org/2000/svg","path")).attr({fill:a[E].color,"data-order":E}).appendTo(A)}q(M);function M(t){var e=-f/2,n=1;if(l.animation&&l.animateRotate)n=t;S(t,y);A.attr("opacity",t);for(var i=0,r=a.length;i<r;i++){if(a[i].value>0){var p=n*(a[i].value/y*(f*2)),c=e+p,w=(c-e)%(f*2)>f?1:0,g=o+s(e)*h,x=u+m(e)*h,b=o+s(e)*v,T=u+m(e)*v,C=o+s(c)*h,O=u+m(c)*h,N=o+s(c)*v,E=u+m(c)*v;var F=["M",g,x,"A",h,h,0,w,1,C,O,"L",N,E,"A",v,v,0,w,0,b,T,"Z"];d[i].attr("d",F.join(" "));e+=p}}}function S(t,a){N.css({opacity:t}).text((a*t).toFixed(1))}function R(t,a){var e=l.animation?j(g(t),null,0):1;a(e)}function q(t){var a=l.animation?1/j(l.animationSteps,Number.MAX_VALUE,1):1,e=l.animation?0:1;c(function(){e+=a;R(e,t);if(e<=1){c(arguments.callee)}else{l.afterDrawed.call(n)}})}function D(t){return Math.max.apply(null,t)}function I(t){return Math.min.apply(null,t)}function L(t){return!isNaN(parseFloat(t))&&isFinite(t)}function j(t,a,e){if(L(a)&&t>a)return a;if(L(e)&&t<e)return e;return t}return n}});