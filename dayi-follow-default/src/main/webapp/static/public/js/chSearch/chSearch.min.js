$.fn.chSearch=function(e){var t={relative:true,mustRelative:false,searchBox:[],relativeSearchBox:[],searchLink:[],dataList:[],dataType:[],size:["auto","auto"]};var a=this;String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var r=function(e){a.config=$.extend({},t,e);var r=a.config.searchBox;i(r)};var i=function(e){$.each(e,function(e,t){var r,i=a.config.relativeSearchBox,h=a.config.searchLink;$(t).on("focus",function(){var t=this,l="",s={},u=a.config.relative,v=a.config.mustRelative,p=a.config.dataList,g=a.config.dataType;$.each(i,function(e,t){var a=$(t).attr("data-type"),r=$(t).val();s[a]=r;l+=r});if((l==""||!u)&&!v){r=n(p[e])}else{if(l==""){return false}$.getJSON(h[e]+"?callback=?",s,function(a){var i=[],h=a.items,l=f(h,g[e]);r=n(l);for(var s=0;s<r.length;s++){i.push(r[s][1])}if(i.length==0){c();return false}o(t,i)})}});$(t).on("blur",function(){c()});$(t).on("keyup",function(){var e=this,t=[],a=false;keyCache=$(this).val().trim(),keyLength=keyCache.length;if(keyCache==""){c();return false}for(var i=0;i<keyLength;i++){var n=keyCache.charCodeAt(i);if(n<=40869&&n>=19968){a=true}}if(!r.length){return false}if(a){for(var i=0;i<r.length;i++){var f=r[i][1].indexOf(keyCache);if(f>-1){t.push(r[i][1])}}}else{keyCache=keyCache.toLowerCase();for(var i=0;i<r.length;i++){var h=r[i][0].substr(0,keyLength);h=h.toLowerCase();if(h==keyCache){t.push(r[i][1])}}}if(t.length==0){c();return false}o(e,t)})})};var n=function(e){var t=[];for(var a=0;a<e.length;a++){if(e[a]!=""){var r=makePy(e[a]);t.push(new Array(r.toString(),e[a]))}}return t};var o=function(e,t){var r=$("body").find(".createSelect").length;if(r>0){$(".createSelect").remove()}var i=$('<ul class="createSelect">');eleLeft=parseInt($(e).offset().left),eleTop=parseInt($(e).offset().top),eleWidth=parseInt($(e).innerWidth()),eleHeight=parseInt($(e).outerHeight()),optWidth=a.config.size[0],optHeight=a.config.size[1];optWidth=optWidth=="auto"?eleWidth:parseInt(optWidth);optHeight=optHeight=="auto"?parseInt(eleHeight):parseInt(optHeight);var n="";for(var o=0;o<t.length;o++){var c='<li title=" '+t[o]+' ">'+t[o]+"</li>";n+=c;i.append($(c))}var f=parseInt(eleTop)+parseInt(optHeight)-1;i.css({position:"absolute",left:eleLeft,top:f,width:optWidth,maxHeight:optHeight*5,overflow:"scroll","z-index":999999999});$("body").append(i);i.on("click","li",function(){var t=$(this).html();$(e).val(t);i.css("display","none")})};var c=function(){var e=$("body").find(".createSelect").length;if(e>0){setTimeout(function(){$(".createSelect").off();$(".createSelect").remove()},200)}};var f=function(e,t){var a=[];$.each(e,function(e,r){a.push(r[t])});return a};r(e);return this};