var bankselector={};bankselector.list=[{id:"1",name:"工商银行",site:"http://www.icbc.com.cn/icbc/"},{id:"2",name:"农业银行",site:"http://www.abchina.com/cn/"},{id:"3",name:"中国银行",site:"http://www.boc.cn/"},{id:"4",name:"建设银行",site:"http://www.ccb.com/cn/home/indexv3.html"},{id:"8",name:"交通银行",site:"http://www.bankcomm.com/BankCommSite/default.shtml"},{id:"9",name:"邮储银行",site:"http://www.psbc.com/cn/index.html"},{id:"10",name:"中信银行",site:"http://bank.ecitic.com/"},{id:"11",name:"光大银行",site:"http://www.cebbank.com/"},{id:"12",name:"华夏银行",site:"http://www.hxb.com.cn/home/cn/"},{id:"13",name:"民生银行",site:"http://www.cmbc.com.cn/"},{id:"14",name:"广发银行",site:"http://www.cgbchina.com.cn/"},{id:"15",name:"平安银行",site:"http://one.pingan.com/"},{id:"16",name:"招商银行",site:"http://www.cmbchina.com/"},{id:"17",name:"兴业银行",site:"http://www.cib.com.cn/cn/index.html"},{id:"18",name:"浦东发展银行",site:"http://www.spdb.com.cn/"},{id:"19",name:"东莞银行",site:"http://www.dongguanbank.cn/Site/Home/CN"},{id:"26",name:"东莞农村商业银行",site:"http://www.drcbank.com/"},{id:"58",name:"北京银行",site:"http://www.bankofbeijing.com.cn/ebank/onlinebank/"},{id:"59",name:"顺德农村商业银行",site:"http://www.sdebank.com/cms/S101_21/ebank/perbank/pc/index.html"}];bankselector.getBankInfo=function(t){var a=bankselector.list;var n=a.length;for(var e=0;e<n;e++){if(t==a[e].id){return a[e]}}return null};bankselector.box=function(t){var a=null,n=null;$.ajax({url:"/api/bank/get/bank/all.json",dataType:"json",async:false,success:function(t){a=t}});$.ajax({url:"/api/bank/get/province/all.json",dataType:"json",async:false,success:function(t){n=t}});if(a==null||n==null){layer.alert('<p style="text-align:center;">数据获取出错</p>',"温馨提示");return}var e='<form class="bank_select">'+'<table class="form_table box_noborder">'+"<tr>"+'<th width="100">选择银行</th>'+"<td>"+'<select name="bankId" class="inptStyle">'+'<option value="">选择银行</option>'+"</select>"+"</td>"+"</tr>"+"<tr>"+"<th>选择城市</th>"+'<td id="selectCity">'+'<select name="prov" class="inptStyle">'+'<option value="">请选择省</option>'+"</select>"+'<select name="areaId" class="inptStyle" style="margin-left:10px;">'+'<option value="">请选择市</option>'+"</select>"+"</td>"+"</tr>"+"<tr>"+'<th style="vertical-align: top;">选择支行</th>'+"<td>"+'<input type="text" name="bankName" class="inptStyle" placeholder="输入支行关键字" style="margin-right:10px;" />'+'<button type="button" class="btn_style1" data-act="seacher">查询</button>'+'<p class="gray fz12">输入支行关键字查询，并在查询结果列表中选择支行</p>'+"</td>"+"</tr>"+"</table>"+"</form>"+'<div data-rel="branchList" class="branchList"></div>';var i=function(t){var a=null;$.ajax({url:"/api/bank/get/area/all.json",dataType:"json",data:{province:t},async:false,success:function(t){a=t}});if(a==null){layer.alert('<p style="text-align:center;">数据获取出错</p>',"温馨提示")}return a};layer.open({type:1,title:"查询银行",area:["600px","500px"],content:e,success:function(a,e){var l=0;var c=a.find('[name="prov"]');var o=a.find('[name="areaId"]');var r=a.find('[name="bankId"]');var s=a.find('[name="bankName"]');var p=a.find('[data-act="seacher"]');var d=a.find('[data-rel="branchList"]');var m="";var v=bankselector.list;var h=v.length;for(var u=0;u<h;u++){if(!!bankselector.finance&&v[u].id==26){continue}m+='<option value="'+v[u].id+'">'+v[u].name+"</option>"}r.append(m);var f="";var b=n.items;var w=b.length;for(var u=0;u<w;u++){f+='<option value="'+b[u].province+'">'+b[u].province+"</option>"}c.append(f);var k=function(t,a,n){if(t.val()==""){n.val("");layer.tips(a,t);t.focus();return false}return true};r.on("change",function(){if(o.val()!=""){o.change()}});c.on("change",function(){var t='<option value="">请选择市</option>';var a=$(this).val();if(a==""){o.html(t);return}if(!k(r,"请先选择银行",$(this))){return}var n=i(a);if(n==null){return}var e=n.items;var l=e.length;var t='<option value="">请选择市</option>';for(var c=0;c<l;c++){t+='<option value="'+e[c].id+'">'+e[c].city+"</option>"}o.html(t)});o.on("change",function(){if(o.val()!=""){l=1;p.click()}});s.on("keydown",function(){k(o,"请先选择城市",$(this))});r.on("change",function(){if($(this).val()==""){s.val("")}});p.on("click",function(){if(l==0&&s.val()==""&&o.val()==""){layer.tips("输入支行关键字",s);return false}$.ajax({url:"/api/bank/get/bankCode/all.json",dataType:"json",data:a.find("form").serialize(),async:false,success:function(a){if(a.fail){layer.alert('<p style="text-align:center;color:red;">'+a.msg+"</p>","温馨提示")}var n=r.val();var i=r.find(":selected").text();var l=a.items;var s=l.length;var p=c.find(":selected").html();var m=o.find(":selected").html();var v='<ul style="padding:0 20px;overflow: auto;height:200px;">';for(var h=0;h<s;h++){v+='<li><label><input type="radio" name="branch" value="'+l[h].number+'" data-name="'+l[h].name+'" data-bankid="'+n+'" data-bank="'+i+'"  data-prov="'+p+'" data-city="'+m+'"/> '+l[h].name+"</label></li>"}v+="</ul>";d.html(v);d.find('[name="branch"]').on("click",function(){t($(this));layer.close(e)})}});l=0})}})};