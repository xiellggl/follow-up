(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function($){$.extend({handleError:function(e,t,r,a){if(e.error){e.error.call(e.context||e,t,r,a)}if(e.global){(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,a])}},createUploadIframe:function(e,t){var r="jUploadFrame"+e;var a='<iframe id="'+r+'" name="'+r+'" style="position:absolute; top:-9999px; left:-9999px"';if(window.ActiveXObject){if(typeof t=="boolean"){a+=' src="'+"javascript:false"+'"'}else if(typeof t=="string"){a+=' src="'+t+'"'}}a+=" />";jQuery(a).appendTo(document.body);return jQuery("#"+r).get(0)},createUploadForm:function(e,t){var r="jUploadForm"+e;var a="jUploadFile"+e;var n=$('<form  action="" method="POST" name="'+r+'" id="'+r+'" enctype="multipart/form-data"></form>');var o=$("#"+t);var i=$(o).clone();$(o).attr("id",a);$(o).before(i);$(o).appendTo(n);$(n).css("position","absolute");$(n).css("top","-1200px");$(n).css("left","-1200px");$(n).appendTo("body");return n},ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime();var r=jQuery.createUploadForm(t,e.fileElementId);var a=jQuery.createUploadIframe(t,e.secureuri);var n="jUploadFrame"+t;var o="jUploadForm"+t;if(e.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var i=false;var d={};if(e.global){jQuery.event.trigger("ajaxSend",[d,e])}var u=function(t){var a=document.getElementById(n);try{if(a.contentWindow){d.responseText=a.contentWindow.document.body?a.contentWindow.document.body.innerHTML:null;d.responseXML=a.contentWindow.document.XMLDocument?a.contentWindow.document.XMLDocument:a.contentWindow.document}else if(a.contentDocument){d.responseText=a.contentDocument.document.body?a.contentDocument.document.body.innerHTML:null;d.responseXML=a.contentDocument.document.XMLDocument?a.contentDocument.document.XMLDocument:a.contentDocument.document}}catch(o){jQuery.handleError(e,d,null,o)}if(d||t=="timeout"){i=true;var u;try{u=t!="timeout"?"success":"error";if(u!="error"){var c=jQuery.uploadHttpData(d,e.dataType);if(e.success){e.success(c,u)}if(e.global){jQuery.event.trigger("ajaxSuccess",[d,e])}}else{jQuery.handleError(e,d,u)}}catch(o){u="error";jQuery.handleError(e,d,u,o)}if(e.global){jQuery.event.trigger("ajaxComplete",[d,e])}if(e.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}if(e.complete){e.complete(d,u)}jQuery(a).unbind();setTimeout(function(){try{$(a).remove();$(r).remove()}catch(t){jQuery.handleError(e,d,null,t)}},100);d=null}};if(e.timeout>0){setTimeout(function(){if(!i)u("timeout")},e.timeout)}try{var r=$("#"+o);$(r).attr("action",e.url);$(r).attr("method","POST");$(r).attr("target",n);if(r.encoding){r.encoding="multipart/form-data"}else{r.enctype="multipart/form-data"}$(r).submit()}catch(c){jQuery.handleError(e,d,null,c)}if(window.attachEvent){document.getElementById(n).attachEvent("onload",u)}else{document.getElementById(n).addEventListener("load",u,false)}return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data)}if(type=="json"){data=r.responseText;var start=data.indexOf(">");if(start!=-1){var end=data.indexOf("<",start+1);if(end!=-1){data=data.substring(start+1,end)}}if(data.length)eval("data = "+data);else data={}}if(type=="html"){jQuery("<div>").html(data).evalScripts()}return data}})});