var selectArea=function(i){var e={boxId:"areaBox",prov:null,city:null,dist:null,nodata:null,hasSuffix:true,fv:"id",required:true,distAll:false,callback:function(){}};var n=$.extend({},e,i);var s=$("#"+n.boxId);var a=s.find(".prov");var r=s.find(".city");var l=s.find(".dist");var d="name";var o="请选择";if(typeof resumeLang==="string"&&resumeLang=="en"){d="en";o="select"}var f=datajson.City;var u=datajson.town;var c="";var v="";if(n.fv=="name"){n.fv=d}else{n.fv="id"}var p=function(t){var i="";if(n.hasSuffix){i=t;if(typeof resumeLang==="string"){i=resumeLang=="cn"?t:""}}return i};var m=function(t,i){var e=false;var n=t;if(t==null||t==""){return""}if(!e){for(var s in f){if(f[s].name==t){n=t+f[s].s;break}}}return n};function h(t){if(n.required){return""}else{if(typeof resumeLang==="string"&&resumeLang=="en"){d="en"}else{return'<option value="">'+(o+t)+"</option>"}}}var b=function(){temp_html=h("省");for(k=0;k<f.length;k++){if(f[k].id.toString().substr(2,2)=="00"&&f[k].s!=""){temp_html+='<option value="'+f[k][n.fv]+'" data-id="'+f[k].id+'">'+f[k][d]+"</option>"}}a.html(temp_html);t=setTimeout(function(){if(n.prov!=null){a.val(n.prov);y();setTimeout(function(){if(n.city!=null){var t=m(n.city,["市","地区","州"]);r.val(t);g();setTimeout(function(){if(n.dist!=null){l.val(n.dist);n.callback(s)}},1)}},1)}},1);a.unbind("change",y);a.bind("change",y);r.unbind("change",g);r.bind("change",g)};var y=function(){var t=getSelectedAttr(a,"data-id")||0;r.empty().attr("disabled",true);l.empty().attr("disabled",true);if(t<=0){if(n.nodata=="none"){r.closest("span").css("display","none");l.closest("span").css("display","none")}else if(n.nodata=="hidden"){r.closest("span").css("visibility","hidden");l.closest("span").css("visibility","hidden")}return}temp_html=h("市");if(parseInt(t.substr(0,4),10)>=4100||parseInt(t.substr(0,4),10)<=1300){for(var i in f){if(f[i].id==t&&f[i].s!=""){temp_html+='<option value="'+f[i][n.fv]+p(f[i].s)+'" data-id="'+f[i].id+'">'+f[i][d]+p(f[i].s)+"</option>"}}}else{var e=0;for(k=0;k<f.length;k++){if(f[k].id.toString().substr(0,2)==t.toString().substr(0,2)&&f[k].id!=t&&f[k].s!=""){temp_html+='<option value="'+f[k][n.fv]+p(f[k].s)+'" data-id="'+f[k].id+'">'+f[k][d]+p(f[k].s)+"</option>";e++}}if(e==0){if(n.nodata=="none"){r.closest("span").css("display","none");l.closest("span").css("display","none")}else if(n.nodata=="hidden"){r.closest("span").css("visibility","hidden");l.closest("span").css("visibility","hidden")}}}r.html(temp_html).attr("disabled",false).closest("span").css({display:"",visibility:""});g()};var g=function(){var t=getSelectedAttr(a,"data-id");var i=getSelectedAttr(r,"data-id");l.empty().attr("disabled",true);if(!t>0||!i>0){if(n.nodata=="none"){l.closest("span").css("display","none")}else if(n.nodata=="hidden"){l.closest("span").css("visibility","hidden")}return}temp_html=h("区");var e=0;if(n.distAll){temp_html='<option value="'+i+'" data-id="'+i+'">全市范围</option>'}for(k=0;k<u.length;k++){if(u[k].id.toString().substr(0,4)==i.toString().substr(0,4)){temp_html+='<option value="'+u[k][n.fv]+'" data-id="'+u[k].id+'">'+u[k][d]+"</option>";e++}}if(e==0){if(n.nodata=="none"){l.closest("span").css("display","none")}else if(n.nodata=="hidden"){l.closest("span").css("visibility","hidden")}return}l.html(temp_html).attr("disabled",false).closest("span").css({display:"",visibility:""})};b()};getSelectedAttr=function(t,i){var e=null;t.find("option").each(function(){if($(this).prop("selected")){e=$(this).attr(i)}});return e};function getAreaItem(t){var i=[];var e=0;$(datajson.City).each(function(n,s){if(s["s"]=="市"&&(s["name"].indexOf(t)!=-1||s["en"].indexOf(t)!=-1||s["f"].indexOf(t)!=-1)){i[e]=s;e++}});return i}